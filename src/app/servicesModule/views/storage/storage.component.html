<div class="mt-3rem w-w-b-w">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12 col-offset-1 mx-auto">
          <div class="mt-3r">
            <mdb-card>
  
              <mdb-card-body class="backg-beige">
                <div class="row">
                  <div class="col-12">
                    <mdb-progress-bar class="progress primary-color-dark" mode="indeterminate" *ngIf="searching"></mdb-progress-bar>
                  </div>
                </div>
                <div class="row">
                  <div class="col-12">
                    <h3>Storage</h3>
                  </div>
                </div>
  
                <div class="row">
                  <div class="col-xs-12 col-sm-12  col-md-12 col-lg-12">
                    <div class="row">
                      <div class="col-6">
                        <div class="md-form" id="container-transaction-search">
                          <input [(ngModel)]="transactionHash" type="text" autocomplete="off" id="transactionHash" class="form-control"
                            mdbInputDirective [mdbValidate]="false">
                          <label for="walletname">Search by title</label>
                        </div>
                      </div>
                      <div class="col-1">
                        <div class="mt-3">
                          <a style="background: #565656" mdbBtn floating="true" size="sm" mdbWavesEffect (click)="searchRecord()">
                            <mdb-icon icon="search"></mdb-icon>
                          </a>
                        </div>
                      </div>
                      <div class="col-2">
                      </div>
                      <div class="col-3">
                        <div class="mt-3 float-right">
                          <button mdbBtn type="button" color="default" rounded="true" size="sm" class="waves-light"
                            mdbWavesEffect data-toggle="modal" (click)="openRecordDialog()">Add file</button>
                        </div>
                      </div>
                    </div>
                    <hr>
                  </div>
  
                  <div class="col-xs-12 col-sm-12  col-md-12 col-lg-12">
  
                    <div class="table-responsive">
                      <table mdbTable>
                        <thead>
                          <tr>
                            <th *ngFor="let head of headElements" scope="col">{{head}}</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr mdbTableCol *ngFor="let r of transactionResults.slice().reverse()">
                            <th style="width:30%;vertical-align: middle;" scope="row">{{r.title}}</th>
                            <td style="width:50%;vertical-align: middle;" scope="row">{{r.transactionHash}}</td>
                            <td style="width:10%;vertical-align: middle;text-align: left;" scope="row">
                              <i [ngClass]="r.isEncrypted?'fa fa-lock fa-lg':'fa fa-unlock fa-lg'"></i>
                            </td>
                            <td style="width:5%;vertical-align: middle;text-align: center;" scope="row">
                              <i class="fa fa-download fa-lg" (click)="downloadRecord(r.dataHash,r.type,r.title,r.transactionHash,r.privacy)"></i>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </mdb-card-body>
            </mdb-card>
          </div>
        </div>
      </div>
    </div>
  
    <!-- Download modal -->
    <div mdbModal #dlframe="mdbModal" class="modal fade left" id="dlFrameModal" tabindex="-1" role="dialog"
      aria-labelledby="myDlModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered " role="document">
        <div class="modal-content">
          <div class="modal-header background-gold">
            <p class="heading lead" style="font-weight: 500;">Download file(s)</p>
            <button type="button" class="close" data-dismiss="modal" (click)="dlframe.hide()">
              <span aria-hidden="true" class="white-text">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form [formGroup]="downloadRecordForm" style="color: #757575;" action="#">
              <input type="hidden" formControlName="downloadDatahash" id="downloadDatahash" class="form-control"
                mdbInputDirective />
              <div *ngIf="showDecryptionPassword">
                <div class="row">
                  <div class="col-8">
                    <div class="md-form " id="container-decryption-password-key">
                      <input type="text" [validateSuccess]="false" autocomplete="off" formControlName="decryptionPassword"
                        id="decryptionPassword" class="form-control" mdbInputDirective required minlength="10" />
                      <label for="decryptionPassword">Enter your decryption password</label>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="md-form">
                      <button mdbBtn type="button" size="sm" color="default" rounded="true" class="waves-light"
                        mdbWavesEffect (click)="downloadWithDecryptionPassword()">Download</button>
                    </div>
                  </div>
                </div>
              </div>
              <div *ngIf="showDecryptionKeyPair">
                  <div class="md-form mt-4" id="container-decryption-private-key">
                    <input type="text" [validateSuccess]="false" autocomplete="off" formControlName="decryptionPrivateKey"
                      id="decryptionPrivateKey" class="form-control" mdbInputDirective>
                    <label for="decryptionPrivateKey">Enter decryption private key </label>
                  </div>
                  <div class="md-form mt-4" id="container-decryption-public-key">
                    <input type="text" [validateSuccess]="false" autocomplete="off" formControlName="decryptionPublicKey"
                      id="decryptionPublicKey" class="form-control" mdbInputDirective>
                    <label for="decryptionPublicKey">Enter decryption public key </label>
                  </div>
                  <div class="md-form">
                      <button mdbBtn type="button" size="sm" color="default" rounded="true" class="waves-light"
                      mdbWavesEffect (click)="downloadWithDecryptionKeyPair()">Download</button>
                    </div>
                </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  
    <!-- Record modal-->
    <div mdbModal #frame="mdbModal" class="modal fade left" id="frameModalTop" tabindex="-1" role="dialog"
      aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered " role="document">
        <div class="modal-content">
          <!-- header-->
          <div class="modal-header background-gold">
            <p class="heading lead" style="font-weight: 500;">Add a new file</p>
            <button type="button" class="close" data-dismiss="modal" (click)="frame.hide()">
              <span aria-hidden="true" class="white-text">&times;</span>
            </button>
          </div>
          <!-- Body-->
          <div class="modal-body">
            <form [formGroup]="addRecordForm" (ngSubmit)="addRecord()" style="color: #757575;" action="#">
              <div *ngIf="showPassword">
                <div class="row">
                  <div class="col-8">
                    <div class="md-form " id="container-password-key">
                      <input type="text" [validateSuccess]="false" autocomplete="off" formControlName="password" id="password"
                        class="form-control" mdbInputDirective required [errorMessage]="getError('password')" minlength="8">
                      <label for="password">Enter your password</label>
  
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="md-form">
                      <button mdbBtn type="button" size="sm" color="default" rounded="true" class="waves-light"
                        mdbWavesEffect (click)="showRecordEntryPassword()">OK</button>
                    </div>
  
                  </div>
                </div>
              </div>
  
              <div *ngIf="showRecordEntry">
                <div class="md-form mt-4" id="container-title">
                  <input type="text" autocomplete="off" formControlName="title" id="title" class="form-control"
                    mdbInputDirective [validateSuccess]="false">
                  <label for="title">Enter title</label>
                </div>
                <div class="file-field md-form mt-4" id="container-file-input">
                  <div mdbBtn color="default" rounded="true" size="sm" class="waves-light" mdbWavesEffect>
                    <span>Choose file</span>
                    <input type="file" mdbFileSelect (uploadOutput)="onUploadOutput($event)" [uploadInput]="uploadInput">
                  </div>
                  <div class="file-path-wrapper">
                    <input class="file-path" type="text" placeholder="Upload your file" [value]="showFiles()">
                  </div>
                </div>
  
                <div class="md-form  mt-4" id="container-encryption">
                  <mdb-select [options]="optionsEncryptionMethods" placeholder="Select encryption method" class="colorful-select dropdown-default"
                    required formControlName="encryptionMethod" [errorMessage]="getError('encryptionMethod')" (selected)="onEncryptionMethodSelected($event)"></mdb-select>
                </div>
  
                <div class="md-form mt-4" id="container-encryption-password" *ngIf="showEncryptionPassword">
                  <input type="text" [validateSuccess]="false" autocomplete="off" formControlName="encryptionPasword" id="encryptionPasword"
                    class="form-control" mdbInputDirective>
                  <label for="encryptionPasword">Enter the encryption password</label>
                </div>
                <div *ngIf="showEncryptionKeyPair">
                  <div class="md-form mt-4" id="container-encryption-private-key">
                    <input type="password" [validateSuccess]="false" autocomplete="off" formControlName="recipientPrivateKey"
                      id="recipientPrivateKey" class="form-control" disabled mdbInputDirective>
                    <label for="recipientPrivateKey">Current encryption private key </label>
                  </div>
                  <div class="md-form mt-4" id="container-encryption-public-key">
                    <input type="text" [validateSuccess]="false" autocomplete="off" formControlName="recipientPublicKey"
                      id="recipientPublicKey" class="form-control" disabled mdbInputDirective>
                    <label for="recipientPublicKey">Current encryption public key </label>
                  </div>
                </div>
  
                <div class="mt-3">
                  <div class="row ">
                    <div class="mx-auto">
                      <div class="row">
                        <div class="col-xs-6">
                          <button mdbBtn type="button" rounded="true" class="waves-light btn-reverse" mdbWavesEffect type="submit"
                            (click)="cleanForm()">Reset</button>
                        </div>
                        <div class="col-xs-6">
                          <button mdbBtn type="button" color="default" rounded="true" class="waves-light" mdbWavesEffect
                            type="submit">Upload</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  